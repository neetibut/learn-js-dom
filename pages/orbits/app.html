<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solar System Orbit</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- OrbitControls for intuitive camera interaction -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>
  </head>
  <body
    class="bg-gray-100 flex items-center justify-center min-h-screen p-4 overflow-hidden"
  >
    <div
      class="bg-white p-6 rounded-2xl shadow-xl w-full max-w-4xl h-screen flex flex-col"
    >
      <h1 class="text-3xl font-bold text-gray-800 mb-4 text-center">
        Sun, Earth and Moon Orbits
      </h1>
      <div
        class="flex-1 relative bg-[url('https://images.pexels.com/photos/1169754/pexels-photo-1169754.jpeg?_gl=1*1i26eq3*_ga*MTYxMDY3NzUxNi4xNzUzMDExMTA1*_ga_8JE65Q40S6*czE3NTMwMTExMDUkbzEkZzEkdDE3NTMwMTExNDckajE4JGwwJGgw')] bg-center bg-cover rounded-lg overflow-hidden"
      >
        <!-- Transparent canvas to let parent background show -->
        <canvas id="orbitCanvas" class="w-full h-full"></canvas>
      </div>
      <p class="text-center text-gray-600 mt-2">
        Drag to rotate view. Scroll to zoom.
      </p>
    </div>

    <script>
      (() => {
        const canvas = document.getElementById("orbitCanvas");
        const scene = new THREE.Scene();
        // Transparent background in renderer to reveal CSS background
        const renderer = new THREE.WebGLRenderer({
          canvas,
          antialias: true,
          alpha: true,
        });
        renderer.setPixelRatio(window.devicePixelRatio);

        // Camera
        const camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
        camera.position.set(0, 150, 250);

        // Controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.enablePan = false;
        controls.minDistance = 100;
        controls.maxDistance = 500;

        // Lights: brighter illumination
        // Ambient fill light
        scene.add(new THREE.AmbientLight(0xffffff, 0.2));
        // Main sunlight
        const sunLight = new THREE.PointLight(0xffffff, 2, 0);
        sunLight.position.set(0, 0, 0);
        scene.add(sunLight);
        // Hemisphere for subtle sky/ground fill
        scene.add(new THREE.HemisphereLight(0x8888ff, 0x442200, 0.2));

        function createSphere(
          radius,
          mapOrColor,
          materialType = "MeshLambertMaterial"
        ) {
          const geometry = new THREE.SphereGeometry(radius, 32, 32);
          const params = {};
          if (typeof mapOrColor === "string") {
            params.map = loader.load(mapOrColor);
          } else if (mapOrColor instanceof THREE.Texture) {
            params.map = mapOrColor;
          } else {
            params.color = mapOrColor;
          }
          const material = new THREE[materialType](params);
          material.transparent = true;
          return new THREE.Mesh(geometry, material);
        }

        // Load textures
        const loader = new THREE.TextureLoader();
        const sunURL =
          "https://upload.wikimedia.org/wikipedia/commons/c/cb/Solarsystemscope_texture_2k_sun.jpg";
        const earthURL =
          "https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg";
        const moonURL =
          "https://threejs.org/examples/textures/planets/moon_1024.jpg";

        // Celestial Bodies
        const sun = createSphere(50, sunURL, "MeshBasicMaterial");
        scene.add(sun);

        const earthOrbit = new THREE.Object3D();
        scene.add(earthOrbit);
        const earth = createSphere(15, earthURL, "MeshPhongMaterial");
        earth.position.set(200, 0, 0);
        earthOrbit.add(earth);

        const moonOrbit = new THREE.Object3D();
        earth.add(moonOrbit);
        const moon = createSphere(5, moonURL, "MeshPhongMaterial");
        moon.position.set(30, 0, 0);
        moonOrbit.add(moon);

        // Resize handling
        function resize() {
          const { clientWidth: w, clientHeight: h } = canvas;
          if (canvas.width !== w || canvas.height !== h) {
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
            renderer.setSize(w, h, false);
          }
        }
        window.addEventListener("resize", resize);
        window.addEventListener("orientationchange", resize);
        resize();

        // Animation loop
        function animate() {
          requestAnimationFrame(animate);
          sun.rotation.y += 0.001;
          earthOrbit.rotation.y += 0.005;
          earth.rotation.y += 0.01;
          moonOrbit.rotation.y += 0.02;
          moon.rotation.y += 0.015;
          controls.update();
          renderer.render(scene, camera);
        }
        animate();
      })();
    </script>
  </body>
</html>
